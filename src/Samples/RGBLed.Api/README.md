# RGB LED æ§åˆ¶å™¨ API

è¿™æ˜¯ä¸€ä¸ªåŸºäº .NET IoT åº“çš„ RGB LED æ§åˆ¶å™¨é¡¹ç›®ï¼Œæ”¯æŒç¡¬ä»¶æŒ‰é’®æ§åˆ¶å’ŒWeb APIæ§åˆ¶ã€‚

## åŠŸèƒ½ç‰¹æ€§

### LED æ•ˆæœ
- âŒ **å…³é—­**: å…³é—­æ‰€æœ‰LED
- ğŸ’¡ **é™æ€**: æ˜¾ç¤ºå›ºå®šé¢œè‰²
- âš¡ **é—ªçƒ**: LEDé—ªçƒæ•ˆæœ
- ğŸ« **å‘¼å¸**: æ¸äº®æ¸æš—çš„å‘¼å¸æ•ˆæœ
- ğŸŒˆ **å½©è™¹**: å¾ªç¯æ˜¾ç¤ºå½©è™¹è‰²å½©

### é¢œè‰²æ”¯æŒ
æ”¯æŒä»¥ä¸‹é¢„å®šä¹‰é¢œè‰²ï¼š
- çº¢è‰² (Red)
- ç»¿è‰² (Green) 
- è“è‰² (Blue)
- ç™½è‰² (White)
- é»„è‰² (Yellow)
- é’è‰² (Cyan)
- æ´‹çº¢ (Magenta)
- æ©™è‰² (Orange)
- ç´«è‰² (Purple)

### æ§åˆ¶æ–¹å¼
1. **ç¡¬ä»¶æŒ‰é’®æ§åˆ¶**
2. **Web API æ§åˆ¶**
3. **Web é¡µé¢æ§åˆ¶**

## ç¡¬ä»¶è¿æ¥

### ğŸ”Œ æ ‘è“æ´¾40é’ˆå¼•è„šå›¾
```
        æ ‘è“æ´¾ GPIO å¼•è„šå›¾ (ä»ä¸Šå¾€ä¸‹çœ‹)
    +3V3  (1) (2)  +5V     â† ç”µæºå¼•è„š
   GPIO2  (3) (4)  +5V     â† I2C SDA
   GPIO3  (5) (6)  GND     â† I2C SCL
   GPIO4  (7) (8)  GPIO14  â† æŒ‰é’®3è¿æ¥è¿™é‡Œ
     GND  (9) (10) GPIO15
  GPIO17 (11) (12) GPIO18  â† çº¢è‰²LEDè¿æ¥è¿™é‡Œ â­
  GPIO27 (13) (14) GND     â† å…¬å…±æ¥åœ°çº¿ â­
  GPIO22 (15) (16) GPIO23
    +3V3 (17) (18) GPIO24
  GPIO10 (19) (20) GND     â† å…¬å…±æ¥åœ°çº¿ â­
   GPIO9 (21) (22) GPIO25
  GPIO11 (23) (24) GPIO8
     GND (25) (26) GPIO7
   GPIO0 (27) (28) GPIO1
   GPIO5 (29) (30) GND
   GPIO6 (31) (32) GPIO12
  GPIO13 (33) (34) GND
  GPIO19 (35) (36) GPIO16  â† ç»¿è‰²LEDè¿æ¥è¿™é‡Œ â­
  GPIO26 (37) (38) GPIO20  â† è“è‰²LEDè¿æ¥è¿™é‡Œ â­
     GND (39) (40) GPIO21

â­ = æœ¬é¡¹ç›®ä½¿ç”¨çš„å¼•è„š
```

### ğŸ¯ è¯¦ç»†æ¥çº¿è¯´æ˜

#### LED æ¨¡å—è¿æ¥ (å…±é˜´æRGB LED)
```
æ ‘è“æ´¾å¼•è„š        â†’  RGB LEDæ¨¡å—
GPIO18 (12å·è„š)   â†’  çº¢è‰²LEDæ­£æ (R+)
GPIO19 (35å·è„š)   â†’  ç»¿è‰²LEDæ­£æ (G+)  
GPIO20 (38å·è„š)   â†’  è“è‰²LEDæ­£æ (B+)
GND (ä»»æ„GNDè„š)   â†’  LEDå…±é˜´æ (-)

æ¨èä½¿ç”¨çš„GNDå¼•è„š: 6å·è„šã€9å·è„šã€14å·è„šã€20å·è„šã€25å·è„šç­‰
```

#### æŒ‰é’®è¿æ¥ (å¸¦å†…éƒ¨ä¸Šæ‹‰ç”µé˜»)
```
æ ‘è“æ´¾å¼•è„š        â†’  æŒ‰é’®          åŠŸèƒ½
GPIO2 (3å·è„š)     â†’  æŒ‰é’®1 ä¸€ç«¯    é¢œè‰²åˆ‡æ¢
GPIO3 (5å·è„š)     â†’  æŒ‰é’®2 ä¸€ç«¯    æ•ˆæœåˆ‡æ¢  
GPIO4 (7å·è„š)     â†’  æŒ‰é’®3 ä¸€ç«¯    äº®åº¦è°ƒèŠ‚
GND (ä»»æ„GNDè„š)   â†’  æ‰€æœ‰æŒ‰é’®å¦ä¸€ç«¯ å…¬å…±æ¥åœ°

æ¨èä½¿ç”¨ 6å·è„š(GND) è¿æ¥æ‰€æœ‰æŒ‰é’®çš„å¦ä¸€ç«¯
```

### ğŸ”§ å®é™…æ¥çº¿æ­¥éª¤

#### ç¬¬ä¸€æ­¥: å‡†å¤‡ææ–™
- æ ‘è“æ´¾ (ä»»æ„å‹å·ï¼Œå¸¦40é’ˆGPIO)
- å…±é˜´æRGB LEDæ¨¡å— æˆ– åˆ†ç«‹çš„çº¢ç»¿è“LED + ç”µé˜»
- 3ä¸ªæŒ‰é’®å¼€å…³
- æœé‚¦çº¿è‹¥å¹² (å…¬å¯¹æ¯æˆ–å…¬å¯¹å…¬)
- é¢åŒ…æ¿ (å¯é€‰ï¼Œæ–¹ä¾¿æ¥çº¿)

#### ç¬¬äºŒæ­¥: LEDæ¨¡å—æ¥çº¿
```
ğŸ”´ çº¢è‰²LEDçº¿:
   æ ‘è“æ´¾ 12å·è„š (GPIO18) â†’ LEDæ¨¡å— R+ å¼•è„š

ğŸŸ¢ ç»¿è‰²LEDçº¿:  
   æ ‘è“æ´¾ 35å·è„š (GPIO19) â†’ LEDæ¨¡å— G+ å¼•è„š

ğŸ”µ è“è‰²LEDçº¿:
   æ ‘è“æ´¾ 38å·è„š (GPIO20) â†’ LEDæ¨¡å— B+ å¼•è„š

âš« æ¥åœ°çº¿:
   æ ‘è“æ´¾ 6å·è„š (GND) â†’ LEDæ¨¡å— GND æˆ– - å¼•è„š
```

#### ç¬¬ä¸‰æ­¥: æŒ‰é’®æ¥çº¿
```
ğŸŸ¡ æŒ‰é’®1 (é¢œè‰²åˆ‡æ¢):
   ä¸€ç«¯ â†’ æ ‘è“æ´¾ 3å·è„š (GPIO2)
   å¦ä¸€ç«¯ â†’ æ ‘è“æ´¾ 6å·è„š (GND)

ğŸŸ¡ æŒ‰é’®2 (æ•ˆæœåˆ‡æ¢):
   ä¸€ç«¯ â†’ æ ‘è“æ´¾ 5å·è„š (GPIO3)  
   å¦ä¸€ç«¯ â†’ æ ‘è“æ´¾ 6å·è„š (GND)

ğŸŸ¡ æŒ‰é’®3 (äº®åº¦è°ƒèŠ‚):
   ä¸€ç«¯ â†’ æ ‘è“æ´¾ 7å·è„š (GPIO4)
   å¦ä¸€ç«¯ â†’ æ ‘è“æ´¾ 6å·è„š (GND)
```

### ğŸ“‹ æ¥çº¿æ£€æŸ¥æ¸…å•
- [ ] çº¢è‰²LED â†’ GPIO18 (12å·è„š)
- [ ] ç»¿è‰²LED â†’ GPIO19 (35å·è„š)  
- [ ] è“è‰²LED â†’ GPIO20 (38å·è„š)
- [ ] LEDåœ°çº¿ â†’ GND (6å·è„š)
- [ ] æŒ‰é’®1 â†’ GPIO2 (3å·è„š) + GND (6å·è„š)
- [ ] æŒ‰é’®2 â†’ GPIO3 (5å·è„š) + GND (6å·è„š)
- [ ] æŒ‰é’®3 â†’ GPIO4 (7å·è„š) + GND (6å·è„š)

### âš ï¸ æ³¨æ„äº‹é¡¹
1. **æ–­ç”µæ¥çº¿**: æ¥çº¿æ—¶ç¡®ä¿æ ‘è“æ´¾å·²å…³æœºæ–­ç”µ
2. **ææ€§æ£€æŸ¥**: LEDæ¨¡å—è¦ç¡®è®¤æ˜¯å…±é˜´æç±»å‹
3. **ç”µé˜»**: å¦‚ä½¿ç”¨åˆ†ç«‹LEDï¼Œéœ€è¦ä¸²è”é™æµç”µé˜»(çº¦220Î©-1kÎ©)
4. **æŒ‰é’®**: ä»£ç å·²é…ç½®å†…éƒ¨ä¸Šæ‹‰ç”µé˜»ï¼Œå¤–éƒ¨æ— éœ€é¢å¤–ç”µé˜»

### ğŸ¨ LEDæ¨¡å—ç±»å‹è¯´æ˜

#### å¦‚æœä½ æœ‰4é’ˆRGB LEDæ¨¡å—:
```
æ¨¡å—æ ‡è¯†     â†’  è¿æ¥ä½ç½®
R+ æˆ– RED   â†’  GPIO18 (12å·è„š)
G+ æˆ– GREEN â†’  GPIO19 (35å·è„š)  
B+ æˆ– BLUE  â†’  GPIO20 (38å·è„š)
GND æˆ– -    â†’  GND (6å·è„š)
```

#### å¦‚æœä½ æœ‰åˆ†ç«‹çš„LED:
æ¯ä¸ªLEDéœ€è¦ä¸²è”ä¸€ä¸ª220Î©ç”µé˜»:
```
GPIO18 â†’ 220Î©ç”µé˜» â†’ çº¢è‰²LEDæ­£æ â†’ LEDè´Ÿæ â†’ GND
GPIO19 â†’ 220Î©ç”µé˜» â†’ ç»¿è‰²LEDæ­£æ â†’ LEDè´Ÿæ â†’ GND  
GPIO20 â†’ 220Î©ç”µé˜» â†’ è“è‰²LEDæ­£æ â†’ LEDè´Ÿæ â†’ GND
```

## æŒ‰é’®åŠŸèƒ½

| æŒ‰é’® | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| æŒ‰é’®1 | é¢œè‰²åˆ‡æ¢ | å¾ªç¯åˆ‡æ¢9ç§é¢„è®¾é¢œè‰² |
| æŒ‰é’®2 | æ•ˆæœåˆ‡æ¢ | å¾ªç¯åˆ‡æ¢5ç§LEDæ•ˆæœ |
| æŒ‰é’®3 | äº®åº¦è°ƒèŠ‚ | å¾ªç¯è°ƒèŠ‚äº®åº¦ï¼š25% â†’ 50% â†’ 75% â†’ 100% |

## API æ¥å£

### è·å–çŠ¶æ€
```http
GET /api/led/status
```

### è®¾ç½®æ•ˆæœ
```http
POST /api/led/effect
Content-Type: application/json

{
  "effect": "Breathe",
  "color": {
    "red": 255,
    "green": 0,
    "blue": 0
  },
  "brightness": 100,
  "speed": 1000
}
```

### å¿«é€Ÿæ§åˆ¶
```http
POST /api/led/off                    # å…³é—­LED
POST /api/led/color                  # è®¾ç½®é™æ€é¢œè‰²
POST /api/led/blink                  # è®¾ç½®é—ªçƒæ•ˆæœ
POST /api/led/breathe                # è®¾ç½®å‘¼å¸æ•ˆæœ
POST /api/led/rainbow                # è®¾ç½®å½©è™¹æ•ˆæœ
```

### è·å–ä¿¡æ¯
```http
GET /api/led/colors                  # è·å–é¢„å®šä¹‰é¢œè‰²
GET /api/led/effects                 # è·å–å¯ç”¨æ•ˆæœ
```

## è¿è¡Œé¡¹ç›®

### 1. æ„å»ºå’Œè¿è¡Œ
```bash
cd src/Samples/RGBLed.Api
dotnet build
dotnet run
```

### 2. è®¿é—®Webç•Œé¢
æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://localhost:5000`

### 3. APIæ–‡æ¡£
è®¿é—®: `http://localhost:5000/swagger` (å¼€å‘ç¯å¢ƒ)

## Web ç•Œé¢åŠŸèƒ½

### çŠ¶æ€é¢æ¿
- LEDé¢„è§ˆæ˜¾ç¤ºå½“å‰é¢œè‰²å’Œæ•ˆæœ
- å®æ—¶æ˜¾ç¤ºå½“å‰æ•ˆæœã€äº®åº¦ã€é€Ÿåº¦
- è‡ªåŠ¨åˆ·æ–°çŠ¶æ€

### æ•ˆæœæ§åˆ¶
- ä¸€é”®åˆ‡æ¢å„ç§LEDæ•ˆæœ
- ç›´è§‚çš„æŒ‰é’®ç•Œé¢

### é¢œè‰²é€‰æ‹©
- 9ç§é¢„å®šä¹‰é¢œè‰²å¿«é€Ÿé€‰æ‹©
- é¢œè‰²æŒ‰é’®å®æ—¶é¢„è§ˆ

### å‚æ•°è°ƒèŠ‚
- äº®åº¦æ»‘å—ï¼š1-100%
- é€Ÿåº¦æ»‘å—ï¼š100-5000ms
- å®æ—¶æ˜¾ç¤ºå‚æ•°å€¼

### é”®ç›˜å¿«æ·é”®
| æŒ‰é”® | åŠŸèƒ½ |
|------|------|
| 0 | å…³é—­LED |
| 1 | é™æ€æ•ˆæœ |
| 2 | é—ªçƒæ•ˆæœ |
| 3 | å‘¼å¸æ•ˆæœ |
| 4 | å½©è™¹æ•ˆæœ |
| R | é€‰æ‹©çº¢è‰² |
| G | é€‰æ‹©ç»¿è‰² |
| B | é€‰æ‹©è“è‰² |
| W | é€‰æ‹©ç™½è‰² |
| ç©ºæ ¼ | åˆ·æ–°çŠ¶æ€ |

## é¡¹ç›®ç»“æ„

```
RGBLed.Api/
â”œâ”€â”€ Controllers/
â”‚   â””â”€â”€ LedController.cs          # LEDæ§åˆ¶API
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ LedEffect.cs              # æ•°æ®æ¨¡å‹
â”œâ”€â”€ Services/
â”‚   â””â”€â”€ RgbLedService.cs          # LEDç¡¬ä»¶æ§åˆ¶æœåŠ¡
â”œâ”€â”€ wwwroot/
â”‚   â”œâ”€â”€ index.html                # Webæ§åˆ¶ç•Œé¢
â”‚   â””â”€â”€ script.js                 # å‰ç«¯JavaScript
â”œâ”€â”€ Program.cs                    # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ RGBLed.Api.csproj            # é¡¹ç›®é…ç½®
â””â”€â”€ RGBLed.Api.http              # APIæµ‹è¯•æ–‡ä»¶
```

## æŠ€æœ¯æ ˆ

- **.NET 9.0**: ä¸»æ¡†æ¶
- **ASP.NET Core**: Web API
- **System.Device.Gpio**: GPIOæ§åˆ¶
- **PWM**: LEDäº®åº¦æ§åˆ¶
- **HTML5/CSS3/JavaScript**: Webç•Œé¢

## æ•…éšœæ’é™¤

### æƒé™é—®é¢˜
å¦‚æœé‡åˆ°GPIOæƒé™é—®é¢˜ï¼Œå¯ä»¥ï¼š
```bash
sudo chmod 666 /dev/gpiomem
# æˆ–è€…ä½¿ç”¨sudoè¿è¡Œç¨‹åº
sudo dotnet run
```

### PWMä¸å¯ç”¨
é¡¹ç›®ä¼šè‡ªåŠ¨æ£€æµ‹PWMå¯ç”¨æ€§ï¼Œå¦‚æœPWMä¸å¯ç”¨ä¼šå›é€€åˆ°GPIOå¼€å…³æ¨¡å¼ã€‚

### æŒ‰é’®æ— å“åº”
æ£€æŸ¥æŒ‰é’®è¿æ¥å’Œä¸Šæ‹‰ç”µé˜»é…ç½®ã€‚

## æ‰©å±•åŠŸèƒ½

### æ·»åŠ æ–°é¢œè‰²
åœ¨ `LedEffect.cs` çš„ `LedColor` ç±»ä¸­æ·»åŠ æ–°çš„é™æ€é¢œè‰²å±æ€§ã€‚

### æ·»åŠ æ–°æ•ˆæœ
1. åœ¨ `LedEffect` æšä¸¾ä¸­æ·»åŠ æ–°æ•ˆæœ
2. åœ¨ `RgbLedService` ä¸­å®ç°æ•ˆæœé€»è¾‘
3. åœ¨Webç•Œé¢ä¸­æ·»åŠ å¯¹åº”æŒ‰é’®

### è‡ªå®šä¹‰GPIOå¼•è„š
åœ¨æœåŠ¡æ³¨å†Œæ—¶ä¼ å…¥è‡ªå®šä¹‰å¼•è„šå·ï¼š
```csharp
builder.Services.AddSingleton(provider => 
    new RgbLedService(redPin: 12, greenPin: 13, bluePin: 14));
```

## è®¸å¯è¯

æ­¤é¡¹ç›®ä½¿ç”¨ MIT è®¸å¯è¯ã€‚
